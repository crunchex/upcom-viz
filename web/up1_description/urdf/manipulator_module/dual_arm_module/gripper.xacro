<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="up1">

  <xacro:include filename="$(find up1_description)/urdf/manipulator_module/dual_arm_module/gripper.gazebo.xacro" />
  <xacro:include filename="$(find up1_description)/urdf/manipulator_module/dual_arm_module/gripper.transmission.xacro" />

  <xacro:property name="finger_offset_x" value="0.01800" />
  <xacro:property name="finger_offset_y" value="0.08121" />
  <xacro:property name="finger_offset_z" value="0" />

  <xacro:macro name="gripper" params="prefix reflect">
    <!-- ============================   Gripper   ============================ -->

    <!-- Finger Joint 1 -->
    <joint name="${prefix}_finger_joint" type="prismatic">
      <parent link="${prefix}_gripper" />
      <child link="${prefix}_finger1" />
      <origin rpy="0 ${pi/2} 0"
        xyz="${-finger_offset_x} ${finger_offset_y} ${finger_offset_z}" />
      <axis xyz="0 0 1" />
      <limit lower="0" upper="${finger_limit_upper}" velocity="${finger1_velocity}" effort="${finger1_effort}" />
    </joint>
    <!-- Finger Link 1 -->
    <link name="${prefix}_finger1">
      <visual>
        <geometry>
          <mesh filename="package://up1_description/meshes/dual_arm/finger.stl" scale="0.001 0.001 0.001" />
        </geometry>
        <material name="grey" />
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://up1_description/meshes/dual_arm/finger.stl" scale="0.001 0.001 0.001" />
        </geometry>
      </collision>
      <inertial>
        <mass value="0.01174"/>
        <inertia ixx="0.00000285949" ixy="-0.00000001641" ixz="0.00000001803"
                 iyy="0.00000203198" iyz="-0.00000077289" izz="0.00000299021"/>
      </inertial>
    </link>

    <!-- Finger Joint 2 -->
    <joint name="${prefix}_finger_joint_fake" type="prismatic">
      <parent link="${prefix}_gripper" />
      <child link="${prefix}_finger2" />
      <origin rpy="0 ${-pi/2} 0"
        xyz="${finger_offset_x} ${finger_offset_y} ${finger_offset_z}" />
      <axis xyz="0 0 1" />
      <limit lower="0" upper="${finger_limit_upper}" velocity="${finger2_velocity}" effort="${finger2_effort}" />
      <mimic joint="${prefix}_finger_joint" multiplier="1" offset="0"/>
    </joint>
    <!-- Finger Link 2 -->
    <link name="${prefix}_finger2">
      <visual>
        <geometry>
          <mesh filename="package://up1_description/meshes/dual_arm/finger.stl" scale="0.001 0.001 0.001" />
        </geometry>
        <material name="grey" />
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://up1_description/meshes/dual_arm/finger.stl" scale="0.001 0.001 0.001" />
        </geometry>
      </collision>
      <inertial>
        <mass value="0.01174"/>
        <inertia ixx="0.00000285949" ixy="-0.00000001641" ixz="0.00000001803"
                 iyy="0.00000203198" iyz="-0.00000077289" izz="0.00000299021"/>
      </inertial>
    </link>

    <xacro:gripper_gazebo prefix="${prefix}" />
    <xacro:gripper_transmission prefix="${prefix}" />

  </xacro:macro>

</robot>
